import{E as M,t as V}from"./Editor-6f153493.js";import{_ as v,r as g,o as s,c as n,b as t,i as a,v as r,F as A,g as k,d as f,D as w,M as C,t as h}from"./index-f0c34798.js";import{P as U}from"./PaginationComponent-8486357e.js";const $={data(){return{tempArticle:{},create_at:0,init:{language:"zh_TW",height:500,menubar:!1,content_css:!1,skin:!1,plugins:this.plugins,toolbar:this.toolbar,quickbars_insert_toolbar:!1,branding:!1}}},components:{Editor:M},props:{articleModal:{},article:{},value:{type:String,default:""},plugins:{type:[String,Array],default:"quickbars emoticons table"},toolbar:{type:[String,Array],default:" bold italic underline strikethrough | fontsizeselect | forecolor backcolor | alignleft aligncenter alignright alignjustify|bullist numlist |outdent indent blockquote | undo redo | axupimgs | removeformat | emoticons |table"}},watch:{article(){this.tempArticle=this.article;var o=new Date(this.tempArticle.create_at*1e3);this.create_at=`${o.getFullYear()}-${o.getMonth()+1<10?"0"+(o.getMonth()+1):o.getMonth()+1}-${o.getDate()<10?"0"+o.getDate():o.getDate()}`},create_at(){this.tempArticle.create_at=Math.floor(new Date(this.create_at)/1e3)}},mounted(){V.init({})}},E={class:"modal-dialog modal-xl",role:"document"},P={class:"modal-content border-0"},D={class:"modal-header bg-dark text-white"},T={class:"modal-title",id:"exampleModalLabel"},S={key:0},B={key:1},L=t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),R={class:"modal-body"},I={class:"row"},q={class:"col-sm-4"},F={class:"mb-3"},H=t("label",{for:"title",class:"form-label"},"標題",-1),z={class:"mb-3"},N=t("label",{for:"image",class:"form-label"},"輸入圖片網址",-1),O={class:"mb-3"},j=t("label",{for:"images",class:"form-label"},"更多圖??",-1),W={class:"mb-3"},X=t("label",{for:"author",class:"form-label"},"分類",-1),Y={class:"mb-3"},G=t("label",{for:"create_at"},"文章建立日期",-1),J={class:"col-sm-8"},K=t("label",{for:"tag",class:"form-label"},"標籤",-1),Q={class:"row gx-1 mb-3"},Z={class:"input-group input-group-sm"},tt=["onUpdate:modelValue"],et=["onClick"],lt={class:"col-md-2 mb-1"},it=["disabled"],ot={class:"mb-3"},st=t("label",{for:"description",class:"form-label"},"文章描述",-1),nt={class:"mb-3"},at={class:"mb-3"},ct={class:"form-check"},rt=t("label",{class:"form-check-label",for:"isPublic"}," 是否公開 ",-1),dt={class:"modal-footer"};function mt(o,e,b,x,l,c){var u;const _=g("editor");return s(),n("div",E,[t("div",P,[t("div",D,[t("h5",T,[l.tempArticle.id?(s(),n("span",S,"編輯貼文")):(s(),n("span",B,"新增貼文"))]),L]),t("div",R,[t("div",I,[t("div",q,[t("div",F,[H,a(t("input",{type:"text",class:"form-control",id:"title","onUpdate:modelValue":e[0]||(e[0]=i=>l.tempArticle.title=i),placeholder:"請輸入標題"},null,512),[[r,l.tempArticle.title]])]),t("div",z,[N,a(t("input",{type:"text",class:"form-control",id:"image","onUpdate:modelValue":e[1]||(e[1]=i=>l.tempArticle.imageUrl=i),placeholder:"請輸入圖片連結"},null,512),[[r,l.tempArticle.imageUrl]])]),t("div",O,[j,a(t("input",{type:"text",class:"form-control",id:"images","onUpdate:modelValue":e[2]||(e[2]=i=>l.tempArticle.images=i),placeholder:""},null,512),[[r,l.tempArticle.images]])]),t("div",W,[X,a(t("input",{type:"text",class:"form-control",id:"author","onUpdate:modelValue":e[3]||(e[3]=i=>l.tempArticle.author=i),placeholder:"請輸入標題"},null,512),[[r,l.tempArticle.author]])]),t("div",Y,[G,a(t("input",{type:"date",class:"form-control",id:"create_at","onUpdate:modelValue":e[4]||(e[4]=i=>this.create_at=i)},null,512),[[r,this.create_at]])])]),t("div",J,[K,t("div",Q,[(s(!0),n(A,null,k(l.tempArticle.tag,(i,d)=>(s(),n("div",{class:"col-md-2 mb-1",key:d},[t("div",Z,[a(t("input",{type:"text",class:"form-control form-control",id:"tag","onUpdate:modelValue":y=>l.tempArticle.tag[d]=y,placeholder:"請輸入標籤"},null,8,tt),[[r,l.tempArticle.tag[d]]]),t("button",{type:"button",class:"btn btn-danger",onClick:y=>l.tempArticle.tag.splice(d,1)}," X ",8,et)])]))),128)),t("div",lt,[l.tempArticle.tag?(s(),n("button",{key:0,class:"btn btn-outline-primary btn-sm d-block w-100",type:"button",onClick:e[5]||(e[5]=i=>l.tempArticle.tag.push("")),disabled:l.tempArticle.tag[((u=l.tempArticle.tag)==null?void 0:u.length)-1]==""}," 新增標籤 ",8,it)):(s(),n("button",{key:1,class:"btn btn-outline-primary btn-sm d-block w-100",type:"button",onClick:e[6]||(e[6]=i=>l.tempArticle.tag=[""])}," 新增標籤 "))])]),t("div",ot,[st,a(t("textarea",{type:"text",class:"form-control",id:"description","onUpdate:modelValue":e[7]||(e[7]=i=>l.tempArticle.description=i),placeholder:"請輸入文章描述"},null,512),[[r,l.tempArticle.description]])]),t("div",nt,[f(_,{modelValue:l.tempArticle.content,"onUpdate:modelValue":e[8]||(e[8]=i=>l.tempArticle.content=i),init:l.init},null,8,["modelValue","init"])]),t("div",at,[t("div",ct,[a(t("input",{class:"form-check-input",type:"checkbox","onUpdate:modelValue":e[9]||(e[9]=i=>l.tempArticle.isPublic=i),id:"isPublic"},null,512),[[w,l.tempArticle.isPublic]]),rt])])])])]),t("div",dt,[t("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal",onClick:e[10]||(e[10]=i=>l.tempArticle={content:""})}," 取消 "),l.tempArticle.id?(s(),n("button",{key:0,type:"button",class:"btn btn-primary",onClick:e[11]||(e[11]=i=>this.$emit("editArticle",b.article))}," 確認編輯 ")):(s(),n("button",{key:1,type:"button",class:"btn btn-primary",onClick:e[12]||(e[12]=i=>this.$emit("addArticle",b.article))}," 確認新增 "))])])])}const pt=v($,[["render",mt]]),{VITE_URL:m,VITE_PATH:p}={VITE_URL:"https://vue3-course-api.hexschool.io/v2",VITE_PATH:"healing_chou",BASE_URL:"/HealingChou/",MODE:"production",DEV:!1,PROD:!0,SSR:!1},ut={data(){return{tempArticle:{},articles:[],pagination:{},articleModal:null}},components:{Pagination:U,AdminBlogModal:pt},methods:{getAdminArticles(o=1){this.$http.get(`${m}/api/${p}/admin/articles?page=${o}`).then(e=>{console.log(e.data),this.articles=e.data.articles,this.pagination=e.data.pagination}).catch(e=>{console.log(e)})},addArticle(o){this.$http.post(`${m}/api/${p}/admin/article`,{data:o}).then(e=>{alert(e.data.message),this.articleModal.hide(),this.tempArticle={content:""},this.getAdminArticles()}).catch(e=>{console.log(e)})},editArticle(o){this.$http.put(`${m}/api/${p}/admin/article/${this.tempArticle.id}`,{data:o}).then(e=>{alert(e.data.message),this.articleModal.hide(),this.tempArticle={},this.getAdminArticles()}).catch(e=>{console.log(e)})},deleteArticle(o){window.confirm("確定要刪除?")&&this.$http.delete(`${m}/api/${p}/admin/article/${o}`).then(e=>{alert(e.data.message),this.getAdminArticles()}).catch(e=>{console.log(e)})},selectTempArticle(o){o.id?this.$http.get(`${m}/api/${p}/admin/article/${o.id}`).then(e=>{this.tempArticle=e.data.article}).catch(e=>{console.log(e)}):this.tempArticle=o}},mounted(){this.getAdminArticles(),this.articleModal=new C("#articleModal")}},ht={class:"text-end mt-4"},bt={class:"table mt-4"},_t=t("thead",null,[t("tr",null,[t("th",{style:{width:"200px"}},"標題"),t("th",{style:{width:"200px"}},"分類"),t("th",null,"描述"),t("th",{style:{width:"100px"}},"建立時間"),t("th",{style:{width:"100px"}},"是否公開"),t("th",{style:{width:"120px"}},"編輯")])],-1),gt={key:0},At={key:1},ft={class:"btn-group"},yt=["onClick"],vt=["onClick"],kt={id:"articleModal",ref:"articleModal",class:"modal fade",tabindex:"-1","aria-labelledby":"articleModalLabel","aria-hidden":"true"};function xt(o,e,b,x,l,c){const _=g("pagination"),u=g("admin-blog-modal");return s(),n(A,null,[t("div",null,[t("div",ht,[t("button",{class:"btn btn-primary",type:"button","data-bs-toggle":"modal","data-bs-target":"#articleModal",onClick:e[0]||(e[0]=i=>c.selectTempArticle({tag:[]}))}," 建立新的頁面 ")]),t("table",bt,[_t,t("tbody",null,[(s(!0),n(A,null,k(l.articles,i=>(s(),n("tr",{key:i.id},[t("td",null,h(i.title),1),t("td",null,h(i.author),1),t("td",null,h(i.description),1),t("td",null,h(o.$filters.date(i.create_at)),1),t("td",null,[i.isPublic?(s(),n("span",gt,"已上架")):(s(),n("span",At,"未上架"))]),t("td",null,[t("div",ft,[t("button",{class:"btn btn-outline-primary btn-sm",type:"button","data-bs-toggle":"modal","data-bs-target":"#articleModal",onClick:d=>c.selectTempArticle(i)}," 編輯 ",8,yt),t("button",{class:"btn btn-outline-danger btn-sm",type:"button",onClick:d=>c.deleteArticle(i.id)}," 刪除 ",8,vt)])])]))),128))])]),f(_,{pages:l.pagination,onChangePage:c.getAdminArticles},null,8,["pages","onChangePage"])]),t("div",kt,[f(u,{article:l.tempArticle,"article-modal":l.articleModal,onEditArticle:c.editArticle,onAddArticle:c.addArticle},null,8,["article","article-modal","onEditArticle","onAddArticle"])],512)],64)}const Ct=v(ut,[["render",xt]]);export{Ct as default};
