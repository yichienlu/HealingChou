import{o as L,_ as O}from"./tarot-card-icon-5dc24475.js";import{L as H}from"./LoaderComponent-c729b032.js";import{_ as M,o as c,c as i,b as t,t as u,F as b,h as D,n as p,j as k,r as g,d as h,i as T,f as _,e as F,k as E,v as I,g as N}from"./index-64541ee2.js";const P="/HealingChou/assets/meditation-banner-f2603b7b.jpg";const{VITE_URL:V,VITE_PATH:S}={VITE_URL:"https://vue3-course-api.hexschool.io/v2",VITE_PATH:"healing_chou",BASE_URL:"/HealingChou/",MODE:"production",DEV:!1,PROD:!0,SSR:!1},R={data(){return{months:["January","February","March","April","May","June","July","August","September","October","November","December"],today:{year:0,month:0,date:0,day:0},calendar:{year:0,month:0,date:0,day:0},orders:[],nestedOrders:[],total_pages:0}},props:["time","isLoader"],methods:{getBooked(){this.$http.get(`${V}/api/${S}/orders`).then(a=>{this.total_pages=a.data.pagination.total_pages,this.processBooked()}).catch(a=>{console.log(a)}).finally(()=>{setTimeout(()=>{this.$emit("closeLoader")},1e3)})},async processBooked(){for(let a=1;a<=this.total_pages;a++)await this.getBookedPages(a);this.orders=this.orders.sort((a,e)=>a.user.address-e.user.address)},async getBookedPages(a){return new Promise(e=>{this.$http.get(`${V}/api/${S}/orders?page=${a}`).then(r=>{a==1?this.orders=r.data.orders:this.orders=this.orders.concat(r.data.orders),e()}).catch(r=>{console.log(r)})})},setToday(){const a=new Date;this.today.year=this.calendar.year=a.getFullYear(),this.today.month=this.calendar.month=a.getMonth(),this.today.date=this.calendar.date=a.getDate(),this.today.day=this.calendar.day=a.getDay()},adjustYear(a){this.calendar.year+=a},adjustMonth(a){let e=this.calendar.month+a;e>11?(this.adjustYear(1),this.calendar.month=0):e<0?(this.adjustYear(-1),this.calendar.month=11):this.calendar.month=e},calculateDate(a,e){return new Date(this.calendarMonth[(a-1)*7+e-1].year,this.calendarMonth[(a-1)*7+e-1].month,this.calendarMonth[(a-1)*7+e-1].date)},selectSession(a){this.$emit("selectSession",a)}},computed:{calendarFirstDay(){const a=new Date(this.calendar.year,this.calendar.month,1),e=new Date(this.calendar.year,this.calendar.month,1-a.getDay());return{year:e.getFullYear(),month:e.getMonth(),date:e.getDate(),day:e.getDay()}},calendarMonth(){const a=[];let e;for(let r=0;r<42;r++)e=new Date(this.calendarFirstDay.year,this.calendarFirstDay.month,this.calendarFirstDay.date+r),a.push({year:e.getFullYear(),month:e.getMonth(),date:e.getDate(),day:e.getDay()});return a},bookedTime(){const a=[];for(const e of this.orders)a.push(e.user.address*1);return a}},mounted(){this.setToday(),this.getBooked()}},U={class:"calendar text-center pt-3"},B={class:"month d-flex justify-content-between align-items-center text-center px-3"},A=t("i",{class:"fas fa-angle-left pointer"},null,-1),Y=[A],q={class:"date"},z=t("i",{class:"fas fa-angle-right pointer"},null,-1),J=[z],W=t("div",{class:"weekDay d-flex"},[t("div",null,"日"),t("div",null,"一"),t("div",null,"二"),t("div",null,"三"),t("div",null,"四"),t("div",null,"五"),t("div",null,"六")],-1),$=["data-date","data-timestamp"],G={key:0},K={key:0},Q=["id","value","onClick"],X=["for"],Z={key:1},j={key:0},ee=["id","value","onClick"],te=["for"];function ae(a,e,r,y,o,s){return c(),i("div",U,[t("div",B,[t("button",{type:"button",class:"btn btn-outline-primary prev",onClick:e[0]||(e[0]=l=>s.adjustMonth(-1))},Y),t("div",q,[t("h1",null,u(o.calendar.year),1),t("h2",null,u(o.months[o.calendar.month]),1)]),t("div",{class:"btn btn-outline-primary next",onClick:e[1]||(e[1]=l=>s.adjustMonth(1))},J)]),W,(c(),i(b,null,D(6,l=>t("div",{class:"week d-flex",key:"aaa"+l},[(c(),i(b,null,D(7,n=>t("div",{class:p(["day text-start ps-1",{other:s.calendarMonth[(l-1)*7+n-1].month!==o.calendar.month,saturday:s.calendarMonth[(l-1)*7+n-1].day==6,sunday:s.calendarMonth[(l-1)*7+n-1].day==0,today:s.calendarMonth[(l-1)*7+n-1].year===o.today.year&&s.calendarMonth[(l-1)*7+n-1].month===o.today.month&&s.calendarMonth[(l-1)*7+n-1].date===o.today.date}]),key:"aaa"+n,"data-date":s.calendarMonth[(l-1)*7+n-1].date,"data-timestamp":this.calculateDate(l,n).valueOf()},[t("p",null,u(s.calendarMonth[(l-1)*7+n-1].date),1),s.calculateDate(l,n)>Date.now()&&s.calculateDate(l,n)<Date.now()+864e5*60&&s.calendarMonth[(l-1)*7+n-1].month==o.calendar.month&&s.calculateDate(l,n).getDay()===6?(c(),i("div",G,[(c(),i(b,null,D([10,14,16,20],d=>(c(),i(b,{key:s.calculateDate(l,n).setHours(d,0,0,0)},[s.bookedTime.indexOf(s.calculateDate(l,n).setHours(d,0,0,0))==-1?(c(),i("span",K,[t("input",{type:"radio",class:"btn-check",name:"options",id:s.calculateDate(l,n).setHours(d,0,0,0),value:s.calculateDate(l,n).setHours(d,0,0,0),onClick:f=>s.selectSession(s.calculateDate(l,n).setHours(d,0,0,0))},null,8,Q),t("label",{class:"btn btn-sm btn-outline-primary session-btn me-1",for:s.calculateDate(l,n).setHours(d,0,0,0)},u(d)+":00",9,X)])):k("",!0)],64))),64))])):s.calculateDate(l,n)>Date.now()&&s.calculateDate(l,n)<Date.now()+864e5*60&&s.calendarMonth[(l-1)*7+n-1].month==o.calendar.month&&(s.calculateDate(l,n).getDay()===1||s.calculateDate(l,n).getDay()===2||s.calculateDate(l,n).getDay()===4||s.calculateDate(l,n).getDay()===5)?(c(),i("div",Z,[s.bookedTime.indexOf(s.calculateDate(l,n).setHours(20,0,0,0))==-1?(c(),i("span",j,[t("input",{type:"radio",class:"btn-check",name:"options",id:s.calculateDate(l,n).setHours(20,0,0,0),value:s.calculateDate(l,n).setHours(20,0,0,0),onClick:d=>s.selectSession(s.calculateDate(l,n).setHours(20,0,0,0))},null,8,ee),t("label",{class:"btn btn-sm btn-outline-primary session-btn",for:s.calculateDate(l,n).setHours(20,0,0,0)},"20:00",8,te)])):k("",!0)])):k("",!0)],10,$)),64))])),64))])}const se=M(R,[["render",ae]]);const{VITE_URL:w,VITE_PATH:x}={VITE_URL:"https://vue3-course-api.hexschool.io/v2",VITE_PATH:"healing_chou",BASE_URL:"/HealingChou/",MODE:"production",DEV:!1,PROD:!0,SSR:!1},le={data(){return{isLoading:!1,banner_bg:P,order_bg:L,service:{},tempOrder:{user:{name:"",email:"",tel:"",address:""},message:""},selectedTime:""}},components:{LoaderComponent:H,CalendarComponent:se},methods:{getService(){const{id:a}=this.$route.params;this.$http.get(`${w}/api/${x}/product/${a}`).then(e=>{this.service=e.data.product}).catch(e=>{console.log(e)})},selectSession(a){this.tempOrder.user.address=a;const e=new Intl.DateTimeFormat("zh-TW",{dateStyle:"full",timeStyle:"short",hour12:!1});this.selectedTime=a?e.format(parseInt(a)):""},addToCart(a,{resetForm:e}){let y={product_id:this.$route.params.id,qty:1};this.$http.post(`${w}/api/${x}/cart`,{data:y}).then(()=>{this.addOrder(e)}).catch(o=>{console.log(o)})},addOrder(a){const e=this.tempOrder,r=document.querySelector('input[name="options"]:checked').value;this.tempOrder.user.address=r;const y=new Intl.DateTimeFormat("zh-TW",{dateStyle:"full",timeStyle:"short",hour12:!1});this.$http.post(`${w}/api/${x}/order`,{data:e}).then(()=>{this.$swal.fire({icon:"success",title:"已完成預約",html:`
          ${y.format(parseInt(this.tempOrder.user.address))}  <br />
          ${this.service.title}
          `,footer:"到時見囉！"}).then(()=>{a(),this.$router.push("/services")})}).catch(o=>{console.log(o)})},isPhone(a){return/^(09)[0-9]{8}$/.test(a)?!0:"需要正確的手機號碼"},closeLoader(){this.isLoading=!1}},computed:{calendarFirstDay(){const a=new Date(this.calendar.year,this.calendar.month,1),e=new Date(this.calendar.year,this.calendar.month,1-a.getDay());return{year:e.getFullYear(),month:e.getMonth(),date:e.getDate(),day:e.getDay()}},calendarMonth(){const a=[];let e;for(let r=0;r<42;r++)e=new Date(this.calendarFirstDay.year,this.calendarFirstDay.month,this.calendarFirstDay.date+r),a.push({year:e.getFullYear(),month:e.getMonth(),date:e.getDate(),day:e.getDay()});return a},bookedTime(){const a=[];for(const e of this.orders)a.push(e.user.address*1);return a}},mounted(){this.isLoading=!0,this.getService()}},ne={class:"healing_Theta"},oe=t("br",null,null,-1),re={class:"fs-3 fw-normal"},de={class:"healing_content bg-beige px-3"},ce={class:"container pt-5 pb-5 position-relative"},ie=["innerHTML"],he={class:"py-5"},ue=t("h2",{class:"text-center text-white mb-4"},[t("img",{src:O,alt:"預約療癒"}),_(" 預約療癒 ")],-1),me={key:0,class:"container px-3"},_e={class:"mb-3"},pe=t("label",{for:"inputTime",class:"form-label text-white"},"選擇療癒時間",-1),ye={class:"mb-3"},fe=t("label",{for:"sessionTime",class:"form-label text-white"},[_("時段"),t("span",null,"*")],-1),ge={class:"col-md-6 mb-3"},be=t("label",{for:"inputName",class:"form-label text-white"},[_("姓名"),t("span",null,"*")],-1),ve={class:"col-md-6 mb-3"},De=t("label",{for:"inputTel",class:"form-label text-white"},[_("手機號碼"),t("span",null,"*")],-1),ke={class:"mb-3"},we=t("label",{for:"email",class:"form-label text-white"},[_("email"),t("span",null,"*")],-1),xe={class:"mb-3"},Te=t("label",{for:"formNote",class:"form-label text-white"},"備註 (Line ID、帳號末5碼)",-1),Ve={id:"formNoteHelp",class:"form-text text-light"},Se={class:"fw-bold"},Me=t("div",null,[_(" 匯款資訊：台新銀行 812 敦南分行 "),t("br"),_(" 帳號：28881004008118 "),t("br"),_(" 戶名：沈家舟")],-1),Ce=t("div",{class:""},[t("button",{type:"submit",class:"btn btn-beige text-primary w-100"},"送出")],-1),Le={key:1,class:"d-flex justify-content-center"},Oe=N('<div class="d-inline-block p-3" style="background-color:#fffA;"><p>請聯繫舟舟報名</p><ul class="list-unstyled"><li class="mb-2 d-flex justify-content-between"><span class="me-4">Facebook: </span><a href="https://www.facebook.com/healingchou" target="_blank" class="text-decoration-underline">healingchou</a></li><li class="mb-2 d-flex justify-content-between"><span>Instagram:</span><a href="https://www.instagram.com/chouhealer/" target="_blank" class="text-decoration-underline">chouhealer</a></li><li class="mb-2 d-flex justify-content-between"><span>Line: </span><a href="https://line.me/R/ti/p/%40655bistu" target="_blank" class="text-decoration-underline">@655bistu</a></li></ul></div>',1),He=[Oe];function Fe(a,e,r,y,o,s){const l=g("LoaderComponent"),n=g("CalendarComponent"),d=g("v-field"),f=g("error-message"),C=g("v-form");return c(),i(b,null,[h(l,{class:p([{"d-none":!o.isLoading},"loader"])},null,8,["class"]),t("div",ne,[t("h1",{class:"text-center fs-1 pt-40 pt-lg-80 pb-40 pb-lg-80 lh-1 mb-0 bg-image text-white",style:T([{backgroundImage:`url(${o.banner_bg})`},{"background-position":"center 70%"}])},[_(" 療癒服務 "),oe,t("span",re,u(o.service.title),1)],4),t("section",de,[t("div",ce,[t("h2",null,u(o.service.title),1),t("div",{innerHTML:o.service.content},null,8,ie),t("div",null,"收費："+u(a.$filters.currency(o.service.price))+" / "+u(o.service.unit),1)])]),t("section",{class:"healing_reserve bg-image",style:T({backgroundImage:`url(${o.order_bg})`})},[t("div",he,[ue,o.service.origin_price?(c(),i("div",me,[h(C,{ref:"form",class:"row service-form",onSubmit:s.addToCart},{default:F(({errors:v})=>[t("div",_e,[pe,h(n,{onSelectSession:s.selectSession,onCloseLoader:s.closeLoader},null,8,["onSelectSession","onCloseLoader"])]),t("div",ye,[fe,h(d,{id:"sessionTime",name:"時段",type:"text",class:p(["form-control",{"is-invalid":v.時段}]),placeholder:"請在上方月曆點選時段",rules:"required",modelValue:this.selectedTime,"onUpdate:modelValue":e[0]||(e[0]=m=>this.selectedTime=m),readonly:!0},null,8,["class","modelValue"]),h(f,{name:"時段",class:"invalid-feedback"})]),t("div",ge,[be,h(d,{id:"inputName",name:"姓名",type:"text",class:p(["form-control",{"is-invalid":v.姓名}]),placeholder:"請輸入姓名",rules:"required",modelValue:this.tempOrder.user.name,"onUpdate:modelValue":e[1]||(e[1]=m=>this.tempOrder.user.name=m)},null,8,["class","modelValue"]),h(f,{name:"姓名",class:"invalid-feedback"})]),t("div",ve,[De,h(d,{id:"inputTel",name:"電話",type:"tel",class:p(["form-control",{"is-invalid":v.電話}]),placeholder:"請輸入電話",rules:s.isPhone,modelValue:this.tempOrder.user.tel,"onUpdate:modelValue":e[2]||(e[2]=m=>this.tempOrder.user.tel=m)},null,8,["class","rules","modelValue"]),h(f,{name:"電話",class:"invalid-feedback"})]),t("div",ke,[we,h(d,{id:"email",name:"email",type:"email",class:p(["form-control",{"is-invalid":v.email}]),placeholder:"請輸入 Email",rules:"required|email",modelValue:this.tempOrder.user.email,"onUpdate:modelValue":e[3]||(e[3]=m=>this.tempOrder.user.email=m)},null,8,["class","modelValue"]),h(f,{name:"email",class:"invalid-feedback"})]),t("div",xe,[Te,E(t("textarea",{class:"form-control",id:"formNote",rows:"3",required:"","onUpdate:modelValue":e[4]||(e[4]=m=>this.tempOrder.message=m)},null,512),[[I,this.tempOrder.message]]),t("div",Ve,[t("div",Se,"收費： "+u(o.service.price)+" 元 / "+u(o.service.unit),1),Me])]),Ce]),_:1},8,["onSubmit"])])):(c(),i("div",Le,He))])],4)])],64)}const Pe=M(le,[["render",Fe]]);export{Pe as default};
