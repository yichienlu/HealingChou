import{o as S,_ as L}from"./tarot-card-icon-5dc24475.js";import{L as C}from"./LoaderComponent-f77f7e84.js";import{_ as F,r as w,o as n,c as d,d as u,n as b,b as s,i as T,f as _,t as h,e as N,F as O,h as H,k as f,v as p,j as i,l as U,g as I}from"./index-3f6724fd.js";const B="/HealingChou/assets/meditation-banner-f2603b7b.jpg";const{VITE_URL:y,VITE_PATH:g}={VITE_URL:"https://vue3-course-api.hexschool.io/v2",VITE_PATH:"healing_chou",BASE_URL:"/HealingChou/",MODE:"production",DEV:!1,PROD:!0,SSR:!1},E={data(){return{isLoading:!1,banner_bg:B,order_bg:S,service:{},months:["January","February","March","April","May","June","July","August","September","October","November","December"],tempOrder:{user:{name:"",email:"",tel:"",address:""},message:""},today:{year:0,month:0,date:0,day:0},calendar:{year:0,month:0,date:0,day:0},orders:[],nestedOrders:[],total_pages:0}},components:{LoaderComponent:C},methods:{getService(){const{id:r}=this.$route.params;this.$http.get(`${y}/api/${g}/product/${r}`).then(e=>{this.service=e.data.product}).catch(e=>{console.log(e)})},getBooked(){this.isLoading=!0,this.$http.get(`${y}/api/${g}/orders`).then(r=>{this.total_pages=r.data.pagination.total_pages,this.processBooked()}).catch(r=>{console.log(r)}).finally(()=>{setTimeout(()=>{this.isLoading=!1},1e3)})},async processBooked(){for(let r=1;r<=this.total_pages;r++)await this.getBookedPages(r);this.orders=this.orders.sort((r,e)=>r.user.address-e.user.address)},async getBookedPages(r){return new Promise(e=>{this.$http.get(`${y}/api/${g}/orders?page=${r}`).then(c=>{r==1?this.orders=c.data.orders:this.orders=this.orders.concat(c.data.orders),e()}).catch(c=>{console.log(c)})})},setToday(){const r=new Date;this.today.year=this.calendar.year=r.getFullYear(),this.today.month=this.calendar.month=r.getMonth(),this.today.date=this.calendar.date=r.getDate(),this.today.day=this.calendar.day=r.getDay()},adjustYear(r){this.calendar.year+=r},adjustMonth(r){let e=this.calendar.month+r;e>11?(this.adjustYear(1),this.calendar.month=0):e<0?(this.adjustYear(-1),this.calendar.month=11):this.calendar.month=e},calculateDate(r,e){return new Date(this.calendarMonth[(r-1)*7+e-1].year,this.calendarMonth[(r-1)*7+e-1].month,this.calendarMonth[(r-1)*7+e-1].date)},addToCart(r,{resetForm:e}){let v={product_id:this.$route.params.id,qty:1};this.$http.post(`${y}/api/${g}/cart`,{data:v}).then(()=>{this.addOrder(e)}).catch(o=>{console.log(o)})},addOrder(r){const e=this.tempOrder,c=document.querySelector('input[name="options"]:checked').value;this.tempOrder.user.address=c;const v=new Intl.DateTimeFormat("zh-TW",{dateStyle:"full",timeStyle:"short",hour12:!1});this.$http.post(`${y}/api/${g}/order`,{data:e}).then(()=>{this.$swal.fire({icon:"success",title:"已完成預約",html:`
          ${v.format(parseInt(this.tempOrder.user.address))}  <br />
          ${this.service.title}
          `,footer:"到時見囉！"}),r(),this.$router.push("/services")}).catch(o=>{console.log(o)})},isPhone(r){return/^(09)[0-9]{8}$/.test(r)?!0:"需要正確的手機號碼"}},computed:{calendarFirstDay(){const r=new Date(this.calendar.year,this.calendar.month,1),e=new Date(this.calendar.year,this.calendar.month,1-r.getDay());return{year:e.getFullYear(),month:e.getMonth(),date:e.getDate(),day:e.getDay()}},calendarMonth(){const r=[];let e;for(let c=0;c<42;c++)e=new Date(this.calendarFirstDay.year,this.calendarFirstDay.month,this.calendarFirstDay.date+c),r.push({year:e.getFullYear(),month:e.getMonth(),date:e.getDate(),day:e.getDay()});return r},bookedTime(){const r=[];for(const e of this.orders)r.push(e.user.address*1);return r},selectedTime(){const r=new Intl.DateTimeFormat("zh-TW",{dateStyle:"full",timeStyle:"short",hour12:!1});return this.tempOrder.user.address?r.format(parseInt(this.tempOrder.user.address)):""}},mounted(){this.isLoading=!0,this.setToday(),this.getBooked(),this.getService()}},P={class:"healing_Theta"},R=s("br",null,null,-1),q={class:"fs-3 fw-normal"},A={class:"healing_content bg-beige px-3"},Y={class:"container pt-5 pb-5 position-relative"},z=["innerHTML"],J={class:"py-5"},W=s("h2",{class:"text-center text-white mb-4"},[s("img",{src:L,alt:"預約療癒"}),_(" 預約療癒 ")],-1),G={key:0,class:"container px-3"},K={class:"mb-3"},Q=s("label",{for:"inputTime",class:"form-label text-white"},"選擇療癒時間",-1),X={class:"calendar text-center pt-3"},Z={class:"month"},j=s("i",{class:"fas fa-angle-left"},null,-1),$=[j],ee={class:"date"},te=s("i",{class:"fas fa-angle-right"},null,-1),ae=[te],se=s("div",{class:"weekDay d-flex"},[s("div",null,"日"),s("div",null,"一"),s("div",null,"二"),s("div",null,"三"),s("div",null,"四"),s("div",null,"五"),s("div",null,"六")],-1),le=["data-date","data-timestamp"],re={key:0},oe=["id","value"],ne=["for"],de=["id","value"],ce=["for"],ie=["id","value"],ue=["for"],me=["id","value"],he=["for"],_e={key:1},be=["id","value"],fe=["for"],pe={class:"mb-3"},ye=s("label",{for:"sessionTime",class:"form-label text-white"},[_("時段"),s("span",null,"*")],-1),ge={class:"col-md-6 mb-3"},ve=s("label",{for:"inputName",class:"form-label text-white"},[_("姓名"),s("span",null,"*")],-1),De={class:"col-md-6 mb-3"},ke=s("label",{for:"inputTel",class:"form-label text-white"},[_("手機號碼"),s("span",null,"*")],-1),xe={class:"mb-3"},we=s("label",{for:"email",class:"form-label text-white"},[_("email"),s("span",null,"*")],-1),Oe={class:"mb-3"},Te=s("label",{for:"formNote",class:"form-label text-white"},"備註 (Line ID、帳號末5碼)",-1),He={id:"formNoteHelp",class:"form-text text-light"},Ve={class:"fw-bold"},Me=s("div",null,[_(" 匯款資訊：台新銀行 812 敦南分行 "),s("br"),_(" 帳號：28881004008118 "),s("br"),_(" 戶名：沈家舟")],-1),Se=s("div",{class:""},[s("button",{type:"submit",class:"btn btn-beige text-primary w-100"},"送出")],-1),Le={key:1,class:"d-flex justify-content-center"},Ce=I('<div class="d-inline-block p-3" style="background-color:#fffA;"><p>請聯繫舟舟報名</p><ul class="list-unstyled"><li class="mb-2 d-flex justify-content-between"><span class="me-4">Facebook: </span><a href="https://www.facebook.com/healingchou" target="_blank" class="text-decoration-underline">healingchou</a></li><li class="mb-2 d-flex justify-content-between"><span>Instagram:</span><a href="https://www.instagram.com/chouhealer/" target="_blank" class="text-decoration-underline">chouhealer</a></li><li class="mb-2 d-flex justify-content-between"><span>Line: </span><a href="https://line.me/R/ti/p/%40655bistu" target="_blank" class="text-decoration-underline">@655bistu</a></li></ul></div>',1),Fe=[Ce];function Ne(r,e,c,v,o,t){const V=w("LoaderComponent"),D=w("v-field"),k=w("error-message"),M=w("v-form");return n(),d(O,null,[u(V,{class:b([{"d-none":!o.isLoading},"loader"])},null,8,["class"]),s("div",P,[s("h1",{class:"text-center fs-1 pt-40 pt-lg-80 pb-40 pb-lg-80 lh-1 mb-0 bg-image text-white",style:T([{backgroundImage:`url(${o.banner_bg})`},{"background-position":"center 70%"}])},[_(" 療癒服務 "),R,s("span",q,h(o.service.title),1)],4),s("section",A,[s("div",Y,[s("h2",null,h(o.service.title),1),s("div",{innerHTML:o.service.content},null,8,z),s("div",null,"收費："+h(r.$filters.currency(o.service.price))+" / "+h(o.service.unit),1)])]),s("section",{class:"healing_reserve bg-image",style:T({backgroundImage:`url(${o.order_bg})`})},[s("div",J,[W,o.service.origin_price?(n(),d("div",G,[u(M,{ref:"form",class:"row service-form",onSubmit:t.addToCart},{default:N(({errors:x})=>[s("div",K,[Q,s("div",X,[s("div",Z,[s("button",{type:"button",class:"btn btn-outline-primary prev",onClick:e[0]||(e[0]=a=>t.adjustMonth(-1))},$),s("div",ee,[s("h1",null,h(o.calendar.year),1),s("h2",null,h(o.months[o.calendar.month]),1)]),s("div",{class:"btn btn-outline-primary next",onClick:e[1]||(e[1]=a=>t.adjustMonth(1))},ae)]),se,(n(),d(O,null,H(6,a=>s("div",{class:"week d-flex",key:"aaa"+a},[(n(),d(O,null,H(7,l=>s("div",{class:b(["day text-start ps-1",{other:t.calendarMonth[(a-1)*7+l-1].month!==o.calendar.month,saturday:t.calendarMonth[(a-1)*7+l-1].day==6,sunday:t.calendarMonth[(a-1)*7+l-1].day==0,today:t.calendarMonth[(a-1)*7+l-1].year===o.today.year&&t.calendarMonth[(a-1)*7+l-1].month===o.today.month&&t.calendarMonth[(a-1)*7+l-1].date===o.today.date}]),key:"aaa"+l,"data-date":t.calendarMonth[(a-1)*7+l-1].date,"data-timestamp":this.calculateDate(a,l).valueOf()},[s("p",null,h(t.calendarMonth[(a-1)*7+l-1].date),1),t.calculateDate(a,l)>Date.now()&&t.calculateDate(a,l)<Date.now()+864e5*60&&t.calendarMonth[(a-1)*7+l-1].month==o.calendar.month&&t.calculateDate(a,l).getDay()===6?(n(),d("div",re,[t.bookedTime.indexOf(t.calculateDate(a,l).setHours(10,0,0,0))==-1?f((n(),d("input",{key:0,type:"radio",class:"btn-check",name:"options",id:t.calculateDate(a,l).setHours(10,0,0,0),autocomplete:"off",value:t.calculateDate(a,l).setHours(10,0,0,0),"onUpdate:modelValue":e[2]||(e[2]=m=>this.tempOrder.user.address=m)},null,8,oe)),[[p,this.tempOrder.user.address]]):i("",!0),t.bookedTime.indexOf(t.calculateDate(a,l).setHours(10,0,0,0))==-1?(n(),d("label",{key:1,class:"btn btn-sm btn-outline-primary session-btn me-1",for:t.calculateDate(a,l).setHours(10,0,0,0)},"10:00",8,ne)):i("",!0),t.bookedTime.indexOf(t.calculateDate(a,l).setHours(14,0,0,0))==-1?f((n(),d("input",{key:2,type:"radio",class:"btn-check",name:"options",id:t.calculateDate(a,l).setHours(14,0,0,0),autocomplete:"off",value:t.calculateDate(a,l).setHours(14,0,0,0),"onUpdate:modelValue":e[3]||(e[3]=m=>this.tempOrder.user.address=m)},null,8,de)),[[p,this.tempOrder.user.address]]):i("",!0),t.bookedTime.indexOf(t.calculateDate(a,l).setHours(14,0,0,0))==-1?(n(),d("label",{key:3,class:"btn btn-sm btn-outline-primary session-btn me-1",for:t.calculateDate(a,l).setHours(14,0,0,0)},"14:00",8,ce)):i("",!0),t.bookedTime.indexOf(t.calculateDate(a,l).setHours(16,0,0,0))==-1?f((n(),d("input",{key:4,type:"radio",class:"btn-check",name:"options",id:t.calculateDate(a,l).setHours(16,0,0,0),autocomplete:"off",value:t.calculateDate(a,l).setHours(16,0,0,0),"onUpdate:modelValue":e[4]||(e[4]=m=>this.tempOrder.user.address=m)},null,8,ie)),[[p,this.tempOrder.user.address]]):i("",!0),t.bookedTime.indexOf(t.calculateDate(a,l).setHours(16,0,0,0))==-1?(n(),d("label",{key:5,class:"btn btn-sm btn-outline-primary session-btn me-1",for:t.calculateDate(a,l).setHours(16,0,0,0)},"16:00",8,ue)):i("",!0),t.bookedTime.indexOf(t.calculateDate(a,l).setHours(20,0,0,0))==-1?f((n(),d("input",{key:6,type:"radio",class:"btn-check",name:"options",id:t.calculateDate(a,l).setHours(20,0,0,0),autocomplete:"off",value:t.calculateDate(a,l).setHours(20,0,0,0),"onUpdate:modelValue":e[5]||(e[5]=m=>this.tempOrder.user.address=m)},null,8,me)),[[p,this.tempOrder.user.address]]):i("",!0),t.bookedTime.indexOf(t.calculateDate(a,l).setHours(20,0,0,0))==-1?(n(),d("label",{key:7,class:"btn btn-sm btn-outline-primary session-btn",for:t.calculateDate(a,l).setHours(20,0,0,0)},"20:00",8,he)):i("",!0)])):t.calculateDate(a,l)>Date.now()&&t.calculateDate(a,l)<Date.now()+864e5*60&&t.calendarMonth[(a-1)*7+l-1].month==o.calendar.month&&(t.calculateDate(a,l).getDay()===1||t.calculateDate(a,l).getDay()===2||t.calculateDate(a,l).getDay()===4||t.calculateDate(a,l).getDay()===5)?(n(),d("div",_e,[t.bookedTime.indexOf(t.calculateDate(a,l).setHours(20,0,0,0))==-1?f((n(),d("input",{key:0,type:"radio",class:"btn-check",name:"options",id:t.calculateDate(a,l).setHours(20,0,0,0),autocomplete:"off",value:t.calculateDate(a,l).setHours(20,0,0,0),"onUpdate:modelValue":e[6]||(e[6]=m=>this.tempOrder.user.address=m)},null,8,be)),[[p,this.tempOrder.user.address]]):i("",!0),t.bookedTime.indexOf(t.calculateDate(a,l).setHours(20,0,0,0))==-1?(n(),d("label",{key:1,class:"btn btn-sm btn-outline-primary session-btn",for:t.calculateDate(a,l).setHours(20,0,0,0)},"20:00",8,fe)):i("",!0)])):i("",!0)],10,le)),64))])),64))])]),s("div",pe,[ye,u(D,{id:"sessionTime",name:"時段",type:"text",class:b(["form-control",{"is-invalid":x.時段}]),placeholder:"請在上方月曆點選時段",rules:"required",modelValue:this.selectedTime,"onUpdate:modelValue":e[7]||(e[7]=a=>this.selectedTime=a),readonly:!0},null,8,["class","modelValue"]),u(k,{name:"時段",class:"invalid-feedback"})]),s("div",ge,[ve,u(D,{id:"inputName",name:"姓名",type:"text",class:b(["form-control",{"is-invalid":x.姓名}]),placeholder:"請輸入姓名",rules:"required",modelValue:this.tempOrder.user.name,"onUpdate:modelValue":e[8]||(e[8]=a=>this.tempOrder.user.name=a)},null,8,["class","modelValue"]),u(k,{name:"姓名",class:"invalid-feedback"})]),s("div",De,[ke,u(D,{id:"inputTel",name:"電話",type:"tel",class:b(["form-control",{"is-invalid":x.電話}]),placeholder:"請輸入電話",rules:t.isPhone,modelValue:this.tempOrder.user.tel,"onUpdate:modelValue":e[9]||(e[9]=a=>this.tempOrder.user.tel=a)},null,8,["class","rules","modelValue"]),u(k,{name:"電話",class:"invalid-feedback"})]),s("div",xe,[we,u(D,{id:"email",name:"email",type:"email",class:b(["form-control",{"is-invalid":x.email}]),placeholder:"請輸入 Email",rules:"required|email",modelValue:this.tempOrder.user.email,"onUpdate:modelValue":e[10]||(e[10]=a=>this.tempOrder.user.email=a)},null,8,["class","modelValue"]),u(k,{name:"email",class:"invalid-feedback"})]),s("div",Oe,[Te,f(s("textarea",{class:"form-control",id:"formNote",rows:"3",required:"","onUpdate:modelValue":e[11]||(e[11]=a=>this.tempOrder.message=a)},null,512),[[U,this.tempOrder.message]]),s("div",He,[s("div",Ve,"收費： "+h(o.service.price)+" 元 / "+h(o.service.unit),1),Me])]),Se]),_:1},8,["onSubmit"])])):(n(),d("div",Le,Fe))])],4)])],64)}const Ee=F(E,[["render",Ne]]);export{Ee as default};
