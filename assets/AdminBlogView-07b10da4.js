import{E as M,t as V}from"./Editor-570f60b6.js";import{_ as v,r as g,o as s,c as n,b as t,k as c,l as d,F as A,i as k,d as f,G as w,M as C,t as h}from"./index-f2340031.js";import{P as $}from"./PaginationComponent-8432c04a.js";const U={data(){return{tempArticle:{},create_at:0,init:{language:"zh_TW",height:500,menubar:!1,content_css:!1,skin:!1,plugins:this.plugins,toolbar:this.toolbar,quickbars_insert_toolbar:!1,branding:!1}}},components:{Editor:M},props:{articleModal:{},article:{},value:{type:String,default:""},plugins:{type:[String,Array],default:"quickbars emoticons table"},toolbar:{type:[String,Array],default:" bold italic underline strikethrough | fontsizeselect | forecolor backcolor | alignleft aligncenter alignright alignjustify|bullist numlist |outdent indent blockquote | undo redo | axupimgs | removeformat | emoticons |table"}},watch:{article(){this.tempArticle=this.article;var o=new Date(this.tempArticle.create_at*1e3);this.create_at=`${o.getFullYear()}-${o.getMonth()+1<10?"0"+(o.getMonth()+1):o.getMonth()+1}-${o.getDate()<10?"0"+o.getDate():o.getDate()}`},create_at(){this.tempArticle.create_at=Math.floor(new Date(this.create_at)/1e3)}},mounted(){V.init({})}},E={class:"modal-dialog modal-xl",role:"document"},P={class:"modal-content border-0"},T={class:"modal-header bg-dark text-white"},D={class:"modal-title",id:"exampleModalLabel"},S={key:0},B={key:1},L=t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),R={class:"modal-body"},I={class:"row"},q={class:"col-sm-4"},F={class:"mb-3"},H=t("label",{for:"title",class:"form-label"},"標題",-1),z={class:"mb-3"},N=t("label",{for:"image",class:"form-label"},"輸入圖片網址",-1),O={class:"mb-3"},j=t("label",{for:"author",class:"form-label"},"分類",-1),G={class:"mb-3"},W=t("label",{for:"create_at"},"文章建立日期",-1),X={class:"col-sm-8"},Y=t("label",{for:"tag",class:"form-label"},"標籤",-1),J={class:"row gx-1 mb-3"},K={class:"input-group input-group-sm"},Q=["onUpdate:modelValue"],Z=["onClick"],tt={class:"col-md-2 mb-1"},et=["disabled"],lt={class:"mb-3"},it=t("label",{for:"description",class:"form-label"},"文章描述",-1),ot={class:"mb-3"},st={class:"mb-3"},nt={class:"form-check"},at=t("label",{class:"form-check-label",for:"isPublic"}," 是否公開 ",-1),ct={class:"modal-footer"};function rt(o,e,b,x,l,a){var u;const _=g("editor");return s(),n("div",E,[t("div",P,[t("div",T,[t("h5",D,[l.tempArticle.id?(s(),n("span",S,"編輯貼文")):(s(),n("span",B,"新增貼文"))]),L]),t("div",R,[t("div",I,[t("div",q,[t("div",F,[H,c(t("input",{type:"text",class:"form-control",id:"title","onUpdate:modelValue":e[0]||(e[0]=i=>l.tempArticle.title=i),placeholder:"請輸入標題"},null,512),[[d,l.tempArticle.title]])]),t("div",z,[N,c(t("input",{type:"text",class:"form-control",id:"image","onUpdate:modelValue":e[1]||(e[1]=i=>l.tempArticle.imageUrl=i),placeholder:"請輸入圖片連結"},null,512),[[d,l.tempArticle.imageUrl]])]),t("div",O,[j,c(t("input",{type:"text",class:"form-control",id:"author","onUpdate:modelValue":e[2]||(e[2]=i=>l.tempArticle.author=i),placeholder:"請輸入標題"},null,512),[[d,l.tempArticle.author]])]),t("div",G,[W,c(t("input",{type:"date",class:"form-control",id:"create_at","onUpdate:modelValue":e[3]||(e[3]=i=>this.create_at=i)},null,512),[[d,this.create_at]])])]),t("div",X,[Y,t("div",J,[(s(!0),n(A,null,k(l.tempArticle.tag,(i,r)=>(s(),n("div",{class:"col-md-2 mb-1",key:r},[t("div",K,[c(t("input",{type:"text",class:"form-control form-control",id:"tag","onUpdate:modelValue":y=>l.tempArticle.tag[r]=y,placeholder:"請輸入標籤"},null,8,Q),[[d,l.tempArticle.tag[r]]]),t("button",{type:"button",class:"btn btn-danger",onClick:y=>l.tempArticle.tag.splice(r,1)}," X ",8,Z)])]))),128)),t("div",tt,[l.tempArticle.tag?(s(),n("button",{key:0,class:"btn btn-outline-primary btn-sm d-block w-100",type:"button",onClick:e[4]||(e[4]=i=>l.tempArticle.tag.push("")),disabled:l.tempArticle.tag[((u=l.tempArticle.tag)==null?void 0:u.length)-1]==""}," 新增標籤 ",8,et)):(s(),n("button",{key:1,class:"btn btn-outline-primary btn-sm d-block w-100",type:"button",onClick:e[5]||(e[5]=i=>l.tempArticle.tag=[""])}," 新增標籤 "))])]),t("div",lt,[it,c(t("textarea",{type:"text",class:"form-control",id:"description","onUpdate:modelValue":e[6]||(e[6]=i=>l.tempArticle.description=i),placeholder:"請輸入文章描述"},null,512),[[d,l.tempArticle.description]])]),t("div",ot,[f(_,{modelValue:l.tempArticle.content,"onUpdate:modelValue":e[7]||(e[7]=i=>l.tempArticle.content=i),init:l.init},null,8,["modelValue","init"])]),t("div",st,[t("div",nt,[c(t("input",{class:"form-check-input",type:"checkbox","onUpdate:modelValue":e[8]||(e[8]=i=>l.tempArticle.isPublic=i),id:"isPublic"},null,512),[[w,l.tempArticle.isPublic]]),at])])])])]),t("div",ct,[t("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal",onClick:e[9]||(e[9]=i=>l.tempArticle={content:""})}," 取消 "),l.tempArticle.id?(s(),n("button",{key:0,type:"button",class:"btn btn-primary",onClick:e[10]||(e[10]=i=>this.$emit("editArticle",b.article))}," 確認編輯 ")):(s(),n("button",{key:1,type:"button",class:"btn btn-primary",onClick:e[11]||(e[11]=i=>this.$emit("addArticle",b.article))}," 確認新增 "))])])])}const dt=v(U,[["render",rt]]),{VITE_URL:m,VITE_PATH:p}={VITE_URL:"https://vue3-course-api.hexschool.io/v2",VITE_PATH:"healing_chou",BASE_URL:"/HealingChou/",MODE:"production",DEV:!1,PROD:!0,SSR:!1},mt={data(){return{tempArticle:{},articles:[],pagination:{},articleModal:null}},components:{Pagination:$,AdminBlogModal:dt},methods:{getAdminArticles(o=1){this.$http.get(`${m}/api/${p}/admin/articles?page=${o}`).then(e=>{this.articles=e.data.articles,this.pagination=e.data.pagination}).catch(e=>{console.log(e)})},addArticle(o){this.$http.post(`${m}/api/${p}/admin/article`,{data:o}).then(e=>{alert(e.data.message),this.articleModal.hide(),this.tempArticle={content:""},this.getAdminArticles()}).catch(e=>{console.log(e)})},editArticle(o){this.$http.put(`${m}/api/${p}/admin/article/${this.tempArticle.id}`,{data:o}).then(e=>{alert(e.data.message),this.articleModal.hide(),this.tempArticle={content:""},this.getAdminArticles()}).catch(e=>{console.log(e)})},deleteArticle(o){window.confirm("確定要刪除?")&&this.$http.delete(`${m}/api/${p}/admin/article/${o}`).then(e=>{alert(e.data.message),this.getAdminArticles()}).catch(e=>{console.log(e)})},selectTempArticle(o){o.id?this.$http.get(`${m}/api/${p}/admin/article/${o.id}`).then(e=>{this.tempArticle=e.data.article}).catch(e=>{console.log(e)}):this.tempArticle=o}},mounted(){this.getAdminArticles(),this.articleModal=new C("#articleModal")}},pt={class:"text-end mt-4"},ut={class:"table mt-4"},ht=t("thead",null,[t("tr",null,[t("th",{style:{width:"200px"}},"標題"),t("th",{style:{width:"200px"}},"分類"),t("th",null,"描述"),t("th",{style:{width:"100px"}},"建立時間"),t("th",{style:{width:"100px"}},"是否公開"),t("th",{style:{width:"120px"}},"編輯")])],-1),bt={key:0},_t={key:1},gt={class:"btn-group"},At=["onClick"],ft=["onClick"],yt={id:"articleModal",ref:"articleModal",class:"modal fade",tabindex:"-1","aria-labelledby":"articleModalLabel","aria-hidden":"true"};function vt(o,e,b,x,l,a){const _=g("pagination"),u=g("admin-blog-modal");return s(),n(A,null,[t("div",null,[t("div",pt,[t("button",{class:"btn btn-primary",type:"button","data-bs-toggle":"modal","data-bs-target":"#articleModal",onClick:e[0]||(e[0]=i=>a.selectTempArticle({tag:[]}))}," 建立新的頁面 ")]),t("table",ut,[ht,t("tbody",null,[(s(!0),n(A,null,k(l.articles,i=>(s(),n("tr",{key:i.id},[t("td",null,h(i.title),1),t("td",null,h(i.author),1),t("td",null,h(i.description),1),t("td",null,h(o.$filters.date(i.create_at)),1),t("td",null,[i.isPublic?(s(),n("span",bt,"已上架")):(s(),n("span",_t,"未上架"))]),t("td",null,[t("div",gt,[t("button",{class:"btn btn-outline-primary btn-sm",type:"button","data-bs-toggle":"modal","data-bs-target":"#articleModal",onClick:r=>a.selectTempArticle(i)}," 編輯 ",8,At),t("button",{class:"btn btn-outline-danger btn-sm",type:"button",onClick:r=>a.deleteArticle(i.id)}," 刪除 ",8,ft)])])]))),128))])]),f(_,{pages:l.pagination,onChangePage:a.getAdminArticles},null,8,["pages","onChangePage"])]),t("div",yt,[f(u,{article:l.tempArticle,"article-modal":l.articleModal,onEditArticle:a.editArticle,onAddArticle:a.addArticle},null,8,["article","article-modal","onEditArticle","onAddArticle"])],512)],64)}const Vt=v(mt,[["render",vt]]);export{Vt as default};
